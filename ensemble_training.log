2024-10-28 02:04:11,724 - INFO - Loading training data...
2024-10-28 02:04:11,758 - INFO - Loaded data from preprocessing/2024-10-21-silan/train_cleaned.csv, shape: (20000, 40)
2024-10-28 02:04:11,758 - INFO - Starting ensemble model training...
2024-10-28 02:04:12,176 - INFO - Training models for Cluster 0
2024-10-28 02:04:12,179 - INFO - Training fold 1/5
2024-10-28 02:04:12,207 - ERROR - An error occurred during execution: train() got an unexpected keyword argument 'early_stopping_rounds'
Traceback (most recent call last):
  File "e:\etc\GitHubDesktop\nus-cs5228-group-20\our_work\silan\SVR\1027-release-SVR copy 2.py", line 303, in main
    ensemble.train(X_train, y_train)
  File "e:\etc\GitHubDesktop\nus-cs5228-group-20\our_work\silan\SVR\1027-release-SVR copy 2.py", line 164, in train
    lgb_model = lgb.train(
TypeError: train() got an unexpected keyword argument 'early_stopping_rounds'
2024-10-28 02:04:36,588 - INFO - Loading training data...
2024-10-28 02:04:36,630 - INFO - Loaded data from preprocessing/2024-10-21-silan/train_cleaned.csv, shape: (20000, 40)
2024-10-28 02:04:36,631 - INFO - Starting ensemble model training...
2024-10-28 02:04:37,044 - INFO - Training models for Cluster 0
2024-10-28 02:04:37,046 - INFO - Training fold 1/5
2024-10-28 02:04:38,008 - INFO - Training fold 2/5
2024-10-28 02:04:39,038 - INFO - Training fold 3/5
2024-10-28 02:04:39,928 - INFO - Training fold 4/5
2024-10-28 02:04:41,249 - INFO - Training fold 5/5
2024-10-28 02:04:42,111 - INFO - Training models for Cluster 1
2024-10-28 02:04:42,111 - INFO - Training fold 1/5
2024-10-28 02:04:52,427 - INFO - Training fold 2/5
2024-10-28 02:05:02,462 - INFO - Training fold 3/5
2024-10-28 02:05:12,173 - INFO - Training fold 4/5
2024-10-28 02:05:22,420 - INFO - Training fold 5/5
2024-10-28 02:05:32,712 - INFO - Training models for Cluster 2
2024-10-28 02:05:32,714 - INFO - Training fold 1/5
2024-10-28 02:05:32,848 - INFO - Training fold 2/5
2024-10-28 02:05:32,971 - INFO - Training fold 3/5
2024-10-28 02:05:33,119 - INFO - Training fold 4/5
2024-10-28 02:05:33,253 - INFO - Training fold 5/5
2024-10-28 02:05:33,389 - INFO - Model training completed in 0.95 minutes
2024-10-28 02:05:33,389 - INFO - Saving trained model...
2024-10-28 02:05:34,179 - INFO - Loading test data...
2024-10-28 02:05:34,196 - INFO - Loaded data from preprocessing/2024-10-21-silan/test_cleaned.csv, shape: (5000, 40)
2024-10-28 02:05:34,197 - INFO - Generating predictions...
2024-10-28 02:05:34,197 - INFO - Making predictions...
2024-10-28 02:05:39,237 - INFO - Predictions saved to lgb_svr_ensemble_predictions.csv
2024-10-28 02:05:39,237 - INFO - 
Prediction statistics:
2024-10-28 02:05:39,237 - INFO - Minimum: 4597.628397589049
2024-10-28 02:05:39,237 - INFO - Maximum: 2171401.295336241
2024-10-28 02:05:39,237 - INFO - Mean: 116355.02674833576
2024-10-28 02:05:39,237 - INFO - Median: 79980.75620550229
2024-10-28 02:14:45,460 - INFO - Columns in preprocessing/2024-10-21-silan/train_cleaned.csv: Index(['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback',
       'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan',
       'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car',
       'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck',
       'vehicle_type_van', 'transmission_type_auto',
       'transmission_type_manual', 'almost_new_car', 'coe_car',
       'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars',
       'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car',
       'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars',
       'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power',
       'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax',
       'dereg_value', 'omv', 'arf', 'vehicle_age'],
      dtype='object')
2024-10-28 02:14:45,460 - INFO - Target variable (price) statistics:
2024-10-28 02:14:45,460 - INFO - count    2.000000e+04
mean     1.147607e+05
std      1.557821e+05
min      7.000000e+02
25%      4.898800e+04
50%      7.880000e+04
75%      1.258000e+05
max      2.899999e+06
Name: price, dtype: float64
2024-10-28 02:14:48,843 - INFO - For n_clusters = 2, the average silhouette score is : 0.8549121481209037
2024-10-28 02:14:52,061 - INFO - For n_clusters = 3, the average silhouette score is : 0.668391182461361
2024-10-28 02:14:52,062 - INFO - Optimal number of clusters: 2
2024-10-28 02:14:52,101 - INFO - Price Cluster Information:
2024-10-28 02:14:52,101 - INFO -    cluster       min        max    median  count
0        0     700.0  2788000.0   77500.0  19607
1        1  168000.0  2899999.0  730000.0    393
2024-10-28 02:14:52,113 - INFO - 
Training models for Cluster 0
2024-10-28 02:14:52,118 - INFO - Fold 1
2024-10-28 02:15:05,476 - INFO - Best weights for cluster 0, fold 1: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:15:05,476 - INFO - Fold 2
2024-10-28 02:15:17,410 - INFO - Best weights for cluster 0, fold 2: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:15:17,410 - INFO - Fold 3
2024-10-28 02:15:30,915 - INFO - Best weights for cluster 0, fold 3: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:15:30,915 - INFO - Fold 4
2024-10-28 02:15:41,626 - INFO - Best weights for cluster 0, fold 4: LGB=0.60, CB=0.20, SVR=0.20
2024-10-28 02:15:41,626 - INFO - Fold 5
2024-10-28 02:15:54,745 - INFO - Best weights for cluster 0, fold 5: LGB=0.60, CB=0.20, SVR=0.20
2024-10-28 02:15:54,745 - INFO - Fold 6
2024-10-28 02:16:07,027 - INFO - Best weights for cluster 0, fold 6: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:16:07,027 - INFO - Fold 7
2024-10-28 02:16:18,396 - INFO - Best weights for cluster 0, fold 7: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:16:18,397 - INFO - Fold 8
2024-10-28 02:16:30,888 - INFO - Best weights for cluster 0, fold 8: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:16:30,888 - INFO - Fold 9
2024-10-28 02:16:41,571 - INFO - Best weights for cluster 0, fold 9: LGB=0.60, CB=0.20, SVR=0.20
2024-10-28 02:16:41,572 - INFO - Fold 10
2024-10-28 02:16:55,095 - INFO - Best weights for cluster 0, fold 10: LGB=0.50, CB=0.30, SVR=0.20
2024-10-28 02:16:55,095 - INFO - 
Training models for Cluster 1
2024-10-28 02:16:55,095 - INFO - Fold 1
2024-10-28 02:16:56,322 - INFO - Best weights for cluster 1, fold 1: LGB=0.30, CB=0.30, SVR=0.40
2024-10-28 02:16:56,322 - INFO - Fold 2
2024-10-28 02:16:57,641 - INFO - Best weights for cluster 1, fold 2: LGB=0.40, CB=0.20, SVR=0.40
2024-10-28 02:16:57,641 - INFO - Fold 3
2024-10-28 02:17:00,458 - INFO - Best weights for cluster 1, fold 3: LGB=0.40, CB=0.30, SVR=0.30
2024-10-28 02:17:00,458 - INFO - Fold 4
2024-10-28 02:17:02,111 - INFO - Best weights for cluster 1, fold 4: LGB=0.40, CB=0.20, SVR=0.40
2024-10-28 02:17:02,111 - INFO - Fold 5
2024-10-28 02:17:03,001 - INFO - Best weights for cluster 1, fold 5: LGB=0.30, CB=0.20, SVR=0.50
2024-10-28 02:17:03,001 - INFO - Fold 6
2024-10-28 02:17:06,064 - INFO - Best weights for cluster 1, fold 6: LGB=0.40, CB=0.30, SVR=0.30
2024-10-28 02:17:06,065 - INFO - Fold 7
2024-10-28 02:17:08,052 - INFO - Best weights for cluster 1, fold 7: LGB=0.30, CB=0.20, SVR=0.50
2024-10-28 02:17:08,053 - INFO - Fold 8
2024-10-28 02:17:10,566 - INFO - Best weights for cluster 1, fold 8: LGB=0.30, CB=0.20, SVR=0.50
2024-10-28 02:17:10,566 - INFO - Fold 9
2024-10-28 02:17:11,157 - INFO - Best weights for cluster 1, fold 9: LGB=0.40, CB=0.20, SVR=0.40
2024-10-28 02:17:11,157 - INFO - Fold 10
2024-10-28 02:17:13,045 - INFO - Best weights for cluster 1, fold 10: LGB=0.40, CB=0.20, SVR=0.40
2024-10-28 02:17:13,045 - INFO - 
Total training time: 2.35 minutes
2024-10-28 02:17:13,046 - INFO - Out-of-fold RMSE: 193071.6951
2024-10-28 02:17:13,047 - INFO - Out-of-fold R2: -0.5361
2024-10-28 02:17:13,050 - INFO - 
Top 10 important features:
2024-10-28 02:17:13,050 - INFO -                 importance
feature                   
dereg_value   17842.075077
depreciation   3932.031970
vehicle_age    3883.056602
coe            2272.682619
power          1590.171823
arf            1416.726061
manufactured    963.951633
engine_cap      419.897128
omv             417.666931
coe_car         311.385720
2024-10-28 02:17:14,002 - INFO - Models and preprocessors saved.
2024-10-28 02:17:14,020 - INFO - Columns in preprocessing/2024-10-21-silan/test_cleaned.csv: Index(['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback',
       'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan',
       'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car',
       'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck',
       'vehicle_type_van', 'transmission_type_auto',
       'transmission_type_manual', 'almost_new_car', 'coe_car',
       'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars',
       'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car',
       'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars',
       'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power',
       'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax',
       'dereg_value', 'omv', 'arf', 'vehicle_age'],
      dtype='object')
2024-10-28 02:17:22,560 - INFO - Predictions complete. Submission file saved as 'triple_ensemble_predictions.csv'.
2024-10-28 02:17:22,560 - INFO - 
Prediction statistics:
2024-10-28 02:17:22,561 - INFO - Minimum: 4431.295782315279
2024-10-28 02:17:22,561 - INFO - Maximum: 2123110.1345857717
2024-10-28 02:17:22,561 - INFO - Mean: 116142.10693411417
2024-10-28 02:17:22,562 - INFO - Median: 79970.17454365917
2024-10-28 02:22:03,276 - INFO - Loaded data from preprocessing/2024-10-21-silan/train_cleaned.csv, shape after preprocessing: (20000, 3577)
2024-10-28 02:22:03,889 - INFO - Target variable (price) statistics:
2024-10-28 02:22:03,905 - INFO - count     19666.000000
mean      99323.082833
std       80039.454805
min         700.000000
25%       48800.000000
50%       77800.000000
75%      122794.250000
max      580988.000000
Name: price, dtype: float64
2024-10-28 02:22:07,009 - INFO - n_clusters = 2, silhouette = 0.6611, inertia = 16865047425237.6094
2024-10-28 02:22:10,033 - INFO - n_clusters = 3, silhouette = 0.4679, inertia = 12591246253115.8965
2024-10-28 02:22:10,033 - INFO - Optimal number of clusters: 2
2024-10-28 02:22:10,072 - INFO - Price Cluster Information:
2024-10-28 02:22:10,072 - INFO -    cluster      min       max    median           mean            std  count
0        0    700.0  568800.0   68800.0   77474.794741   48012.318061  16886
1        1  72800.0  580988.0  203800.0  232031.785252  103963.243408   2780
2024-10-28 02:22:10,086 - INFO - 
Training models for Cluster 0
2024-10-28 02:22:10,215 - INFO - Training fold 1
