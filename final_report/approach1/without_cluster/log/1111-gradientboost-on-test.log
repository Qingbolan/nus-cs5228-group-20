Training model...
2024-11-11 18:37:12,978 - INFO - 成功加载数据文件: final_report\preprocessing\self_experiment\train_cleaned.csv. 数据形状: (20000, 42)
2024-11-11 18:37:12,983 - INFO - 特征形状: (20000, 40)
2024-11-11 18:37:12,983 - INFO - 目标变量形状: (20000,)
2024-11-11 18:37:12,984 - INFO - 价格范围: 700.00 到 2899999.00
2024-11-11 18:37:12,984 - INFO - 
目标变量 (price) 统计信息:
2024-11-11 18:37:12,986 - INFO - count    2.000000e+04
mean     1.147607e+05
std      1.557821e+05
min      7.000000e+02
25%      4.898800e+04
50%      7.880000e+04
75%      1.258000e+05
max      2.899999e+06
Name: price, dtype: float64
2024-11-11 18:38:20,338 - INFO - 第 1 折训练完成
2024-11-11 18:38:20,339 - INFO - 第 2 折训练完成
2024-11-11 18:38:20,339 - INFO - 第 3 折训练完成
2024-11-11 18:38:20,339 - INFO - 第 4 折训练完成
2024-11-11 18:38:20,339 - INFO - 第 5 折训练完成
2024-11-11 18:38:20,339 - INFO - 
总训练时间: 1.12 分钟
2024-11-11 18:38:20,340 - INFO - Out-of-fold RMSE: 26953.2844
2024-11-11 18:38:20,340 - INFO - Out-of-fold R2: 0.9701
2024-11-11 18:38:20,342 - INFO - 
Top 10 重要特征:
2024-11-11 18:38:20,342 - INFO -                          importance
feature
dereg_value                0.734985
depreciation               0.075576
vehicle_age                0.052022
power                      0.043988
manufactured               0.027887
coe                        0.021758
omv                        0.017264
arf                        0.011618
coe_car                    0.002523
vehicle_type_sports_car    0.002446
2024-11-11 18:38:20,418 - INFO - 模型和预处理器已保存到 'gradient_boosting_models.pkl'
2024-11-11 18:38:20,486 - INFO - 模型验证成功
2024-11-11 18:38:20,499 - INFO - 成功加载数据文件: final_report\preprocessing\self_experiment\test_cleaned.csv. 数据形状: (5000, 41)
2024-11-11 18:38:20,500 - INFO - 特征形状: (5000, 40)
2024-11-11 18:38:20,500 - INFO - 使用模型 1 进行预测
2024-11-11 18:38:20,501 - INFO - 开始特征预处理
2024-11-11 18:38:20,501 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:38:20,502 - INFO - 分类特征: []
2024-11-11 18:38:20,512 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:38:20,517 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:38:20,518 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:38:20,569 - INFO - 使用模型 2 进行预测
2024-11-11 18:38:20,569 - INFO - 开始特征预处理
2024-11-11 18:38:20,570 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:38:20,571 - INFO - 分类特征: []
2024-11-11 18:38:20,580 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:38:20,584 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:38:20,585 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:38:20,635 - INFO - 使用模型 3 进行预测
2024-11-11 18:38:20,636 - INFO - 开始特征预处理
2024-11-11 18:38:20,636 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:38:20,637 - INFO - 分类特征: []
2024-11-11 18:38:20,645 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:38:20,650 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:38:20,650 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:38:20,700 - INFO - 使用模型 4 进行预测
2024-11-11 18:38:20,701 - INFO - 开始特征预处理
2024-11-11 18:38:20,702 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:38:20,703 - INFO - 分类特征: []
2024-11-11 18:38:20,711 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:38:20,715 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:38:20,715 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:38:20,768 - INFO - 使用模型 5 进行预测
2024-11-11 18:38:20,769 - INFO - 开始特征预处理
2024-11-11 18:38:20,770 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:38:20,770 - INFO - 分类特征: []
2024-11-11 18:38:20,779 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:38:20,785 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:38:20,785 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:38:20,848 - INFO - 预测完成。提交文件已保存为 'final_report\approach1\final_report_submission.csv'
2024-11-11 18:38:20,849 - INFO -
预测统计信息:
2024-11-11 18:38:20,849 - INFO - 最小值: 2749.93
2024-11-11 18:38:20,849 - INFO - 最大值: 2136584.41
2024-11-11 18:38:20,849 - INFO - 均值: 116405.01
2024-11-11 18:38:20,850 - INFO - 中位数: 80182.71
Training model done.
evalute...
RSME: 18569.294987333258

kaggle score: 17829.10606