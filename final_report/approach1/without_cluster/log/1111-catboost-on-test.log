Training model...
2024-11-11 18:40:27,426 - INFO - 成功加载数据文件: final_report\preprocessing\self_experiment\train_cleaned.csv. 数据形状: (20000, 42)
2024-11-11 18:40:27,432 - INFO - 特征形状: (20000, 40)
2024-11-11 18:40:27,433 - INFO - 目标变量形状: (20000,)
2024-11-11 18:40:27,433 - INFO - 价格范围: 700.00 到 2899999.00
2024-11-11 18:40:27,434 - INFO -
目标变量 (price) 统计信息:
2024-11-11 18:40:27,435 - INFO - count    2.000000e+04
mean     1.147607e+05
std      1.557821e+05
min      7.000000e+02
25%      4.898800e+04
50%      7.880000e+04
75%      1.258000e+05
max      2.899999e+06
Name: price, dtype: float64
2024-11-11 18:40:33,128 - INFO - 第 1 折训练完成
2024-11-11 18:40:33,129 - INFO - 第 2 折训练完成
2024-11-11 18:40:33,129 - INFO - 第 3 折训练完成
2024-11-11 18:40:33,129 - INFO - 第 4 折训练完成
2024-11-11 18:40:33,129 - INFO - 第 5 折训练完成
2024-11-11 18:40:33,129 - INFO - 
总训练时间: 0.09 分钟
2024-11-11 18:40:33,130 - INFO - Out-of-fold RMSE: 29495.6031
2024-11-11 18:40:33,130 - INFO - Out-of-fold R2: 0.9641
2024-11-11 18:40:33,132 - INFO - 
Top 10 重要特征:
2024-11-11 18:40:33,132 - INFO -               importance
feature
arf            23.157371
depreciation   18.324538
vehicle_age    13.636297
dereg_value    13.332288
manufactured   10.203125
omv             4.982505
coe             3.813912
power           3.237458
rare_exotic     2.280855
road_tax        1.837461
2024-11-11 18:40:33,142 - INFO - 模型和预处理器已保存到 'catboost_models.pkl'
2024-11-11 18:40:33,152 - INFO - 模型验证成功
2024-11-11 18:40:33,164 - INFO - 成功加载数据文件: final_report\preprocessing\self_experiment\test_cleaned.csv. 数据形状: (5000, 41)
2024-11-11 18:40:33,165 - INFO - 特征形状: (5000, 40)
2024-11-11 18:40:33,165 - INFO - 使用模型 1 进行预测
2024-11-11 18:40:33,165 - INFO - 开始特征预处理
2024-11-11 18:40:33,165 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:40:33,166 - INFO - 分类特征: []
2024-11-11 18:40:33,175 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:40:33,179 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:40:33,180 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:40:33,184 - INFO - 使用模型 2 进行预测
2024-11-11 18:40:33,185 - INFO - 开始特征预处理
2024-11-11 18:40:33,185 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:40:33,186 - INFO - 分类特征: []
2024-11-11 18:40:33,196 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:40:33,200 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:40:33,201 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:40:33,204 - INFO - 使用模型 3 进行预测
2024-11-11 18:40:33,205 - INFO - 开始特征预处理
2024-11-11 18:40:33,205 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:40:33,205 - INFO - 分类特征: []
2024-11-11 18:40:33,213 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:40:33,218 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:40:33,218 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:40:33,222 - INFO - 使用模型 4 进行预测
2024-11-11 18:40:33,223 - INFO - 开始特征预处理
2024-11-11 18:40:33,223 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:40:33,224 - INFO - 分类特征: []
2024-11-11 18:40:33,232 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:40:33,236 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:40:33,237 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:40:33,240 - INFO - 使用模型 5 进行预测
2024-11-11 18:40:33,241 - INFO - 开始特征预处理
2024-11-11 18:40:33,241 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 18:40:33,242 - INFO - 分类特征: []
2024-11-11 18:40:33,250 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 18:40:33,255 - INFO - 使用现有的标准化器标准化数值特征 ['curb_weight', 'power', 'engine_cap', 'depreciation']
2024-11-11 18:40:33,255 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 18:40:33,267 - INFO - 预测完成。提交文件已保存为 'final_report\approach1\final_report_submission.csv'
2024-11-11 18:40:33,267 - INFO -
预测统计信息:
2024-11-11 18:40:33,267 - INFO - 最小值: 3832.19
2024-11-11 18:40:33,268 - INFO - 最大值: 2365973.82
2024-11-11 18:40:33,268 - INFO - 均值: 116811.89
2024-11-11 18:40:33,268 - INFO - 中位数: 79968.09
Training model done.
evalute...
RSME: 23059.250382855033

kaggle score: 20333.47363