Training model...
2024-11-11 19:19:12,695 - INFO - 开始加载训练数据...
2024-11-11 19:19:12,737 - INFO - 成功加载数据文件: final_report\preprocessing\self_experiment\train_cleaned.csv. 数据形状: (20000, 42)
2024-11-11 19:19:12,743 - INFO - 特征列: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:12,744 - INFO - 目标变量形状: (20000,)
2024-11-11 19:19:12,744 - INFO - 价格范围: 700.00 到 2899999.00
2024-11-11 19:19:12,745 - INFO -
目标变量 (price) 统计信息:
2024-11-11 19:19:12,747 - INFO - count    2.000000e+04
mean     1.147607e+05
std      1.557821e+05
min      7.000000e+02
25%      4.898800e+04
50%      7.880000e+04
75%      1.258000e+05
max      2.899999e+06
Name: price, dtype: float64
2024-11-11 19:19:12,748 - INFO - 使用CPU进行训练
2024-11-11 19:19:18,411 - INFO - 第 1 折训练完成
2024-11-11 19:19:18,412 - INFO - 第 2 折训练完成
2024-11-11 19:19:18,412 - INFO - 第 3 折训练完成
2024-11-11 19:19:18,412 - INFO - 第 4 折训练完成
2024-11-11 19:19:18,412 - INFO - 第 5 折训练完成
2024-11-11 19:19:18,412 - INFO -
总训练时间: 0.09 分钟
2024-11-11 19:19:18,413 - INFO - Out-of-fold RMSE: 28283.9042
2024-11-11 19:19:18,413 - INFO - Out-of-fold R2: 0.9670
2024-11-11 19:19:18,415 - INFO -
Top 10 重要特征:
2024-11-11 19:19:18,416 - INFO -               importance
feature
dereg_value     5.408553
rare_exotic     2.734423
arf             2.594036
coe_car         2.474046
depreciation    2.011637
vehicle_age     1.970166
vintage_cars    1.895344
manufactured    1.093568
coe             0.741504
parf_car        0.690838
2024-11-11 19:19:18,573 - INFO - 模型和预处理器已保存到 'xgboost_models.pkl'
2024-11-11 19:19:18,716 - INFO - 模型验证成功
2024-11-11 19:19:18,725 - INFO - 开始加载测试数据...
2024-11-11 19:19:18,739 - INFO - 成功加载数据文件: final_report\preprocessing\self_experiment\test_cleaned.csv. 数据形状: (5000, 41)
2024-11-11 19:19:18,741 - INFO - 特征列: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:18,741 - INFO - 使用模型 1 进行预测
2024-11-11 19:19:18,742 - INFO - 开始特征预处理
2024-11-11 19:19:18,743 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:18,744 - INFO - 分类特征: []
2024-11-11 19:19:18,758 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 19:19:18,759 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 19:19:18,785 - INFO - 使用模型 2 进行预测
2024-11-11 19:19:18,786 - INFO - 开始特征预处理
2024-11-11 19:19:18,787 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:18,787 - INFO - 分类特征: []
2024-11-11 19:19:18,799 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 19:19:18,799 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 19:19:18,821 - INFO - 使用模型 3 进行预测
2024-11-11 19:19:18,822 - INFO - 开始特征预处理
2024-11-11 19:19:18,823 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:18,823 - INFO - 分类特征: []
2024-11-11 19:19:18,835 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 19:19:18,835 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 19:19:18,856 - INFO - 使用模型 4 进行预测
2024-11-11 19:19:18,857 - INFO - 开始特征预处理
2024-11-11 19:19:18,858 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:18,859 - INFO - 分类特征: []
2024-11-11 19:19:18,870 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 19:19:18,871 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 19:19:18,891 - INFO - 使用模型 5 进行预测
2024-11-11 19:19:18,892 - INFO - 开始特征预处理
2024-11-11 19:19:18,893 - INFO - 数值特征: ['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback', 'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan', 'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car', 'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck', 'vehicle_type_van', 'transmission_type_auto', 'transmission_type_manual', 'almost_new_car', 'coe_car', 'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars', 'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car', 'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars', 'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power', 'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax', 'dereg_value', 'omv', 'arf', 'vehicle_age']
2024-11-11 19:19:18,894 - INFO - 分类特征: []
2024-11-11 19:19:18,905 - INFO - 使用现有的数值特征填充器填充数值特征缺失值
2024-11-11 19:19:18,906 - INFO - 完成特征预处理。最终数据形状: (5000, 40)
2024-11-11 19:19:18,937 - INFO - 预测完成。提交文件已保存为 'final_report\approach1\final_report_submission.csv'
2024-11-11 19:19:18,937 - INFO -
预测统计信息:
2024-11-11 19:19:18,938 - INFO - 最小值: 3528.43
2024-11-11 19:19:18,938 - INFO - 最大值: 2479887.40
2024-11-11 19:19:18,938 - INFO - 均值: 116441.84
2024-11-11 19:19:18,938 - INFO - 中位数: 79689.23
Training model done.
evalute...
RSME: 22611.427921792114

kaggle score: 21890.49993