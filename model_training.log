2024-11-08 03:39:15,489 - INFO - Columns in train_cleaned.csv: Index(['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback',
       'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan',
       'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car',
       'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck',
       'vehicle_type_van', 'transmission_type_auto',
       'transmission_type_manual', 'almost_new_car', 'coe_car',
       'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars',
       'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car',
       'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars',
       'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power',
       'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax',
       'dereg_value', 'omv', 'arf', 'vehicle_age'],
      dtype='object')
2024-11-08 03:39:15,490 - INFO - Target variable (price) statistics:
2024-11-08 03:39:15,491 - INFO - count    2.000000e+04
mean     1.147607e+05
std      1.557821e+05
min      7.000000e+02
25%      4.898800e+04
50%      7.880000e+04
75%      1.258000e+05
max      2.899999e+06
Name: price, dtype: float64
2024-11-08 03:39:18,845 - INFO - For n_clusters = 2, the average silhouette score is : 0.7693690495872721
2024-11-08 03:39:22,051 - INFO - For n_clusters = 3, the average silhouette score is : 0.5831620063085143
2024-11-08 03:39:25,255 - INFO - For n_clusters = 4, the average silhouette score is : 0.5777886593863528
2024-11-08 03:39:28,442 - INFO - For n_clusters = 5, the average silhouette score is : 0.5195662217033725
2024-11-08 03:39:28,442 - INFO - Optimal number of clusters: 2
2024-11-08 03:39:28,829 - INFO - Price Cluster Information:
2024-11-08 03:39:28,829 - INFO -    cluster       min        max    median  count
0        0  105000.0  2899999.0  555844.0    734
1        1     700.0  1200000.0   75900.0  19266
2024-11-08 03:39:28,841 - INFO - 
Training models for Cluster 0
2024-11-08 03:39:28,842 - INFO - Cluster 0 - Fold 1
2024-11-08 03:39:31,809 - INFO - Cluster 0 - Fold 2
2024-11-08 03:39:34,434 - INFO - Cluster 0 - Fold 3
2024-11-08 03:39:36,907 - INFO - Cluster 0 - Fold 4
2024-11-08 03:39:39,523 - INFO - Cluster 0 - Fold 5
2024-11-08 03:39:42,090 - INFO - Model lgb - Average RMSE: 140892.5511
2024-11-08 03:39:42,090 - INFO - Model xgb - Average RMSE: 114978.0608
2024-11-08 03:39:42,090 - INFO - Model cat - Average RMSE: 107785.9832
2024-11-08 03:39:42,090 - INFO - Model rf - Average RMSE: 140231.0963
2024-11-08 03:39:42,090 - INFO - Model etr - Average RMSE: 133189.0179
2024-11-08 03:39:42,091 - INFO - Model gbr - Average RMSE: 125337.3638
2024-11-08 03:39:42,091 - INFO - Model Weights: [0.14882724 0.18237088 0.19453967 0.14952925 0.15743528 0.16729768]
2024-11-08 03:39:42,091 - INFO - Cluster 0 OOF RMSE: 119876.2928, R2: 0.9305
2024-11-08 03:39:42,093 - INFO - 
Training models for Cluster 1
2024-11-08 03:39:42,094 - INFO - Cluster 1 - Fold 1
2024-11-08 03:40:06,607 - INFO - Cluster 1 - Fold 2
2024-11-08 03:40:31,266 - INFO - Cluster 1 - Fold 3
2024-11-08 03:40:56,118 - INFO - Cluster 1 - Fold 4
2024-11-08 03:41:20,782 - INFO - Cluster 1 - Fold 5
2024-11-08 03:41:45,244 - INFO - Model lgb - Average RMSE: 15218.0429
2024-11-08 03:41:45,244 - INFO - Model xgb - Average RMSE: 14484.6816
2024-11-08 03:41:45,244 - INFO - Model cat - Average RMSE: 12495.7500
2024-11-08 03:41:45,244 - INFO - Model rf - Average RMSE: 15996.3496
2024-11-08 03:41:45,246 - INFO - Model etr - Average RMSE: 17148.6652
2024-11-08 03:41:45,246 - INFO - Model gbr - Average RMSE: 14504.5197
2024-11-08 03:41:45,246 - INFO - Model Weights: [0.16243143 0.17065535 0.19781833 0.15452828 0.14414466 0.17042194]
2024-11-08 03:41:45,246 - INFO - Cluster 1 OOF RMSE: 14583.7260, R2: 0.9509
2024-11-08 03:41:45,247 - INFO - 
Total training time: 2.27 minutes
2024-11-08 03:41:45,248 - INFO - Out-of-fold RMSE: 27060.4965
2024-11-08 03:41:45,248 - INFO - Out-of-fold R2: 0.9698
2024-11-08 03:41:45,249 - INFO - Retraining models for Cluster 0 on full data
2024-11-08 03:41:45,304 - INFO - Model lgb - Retrained RMSE: 102217.7667
2024-11-08 03:41:45,403 - INFO - Model xgb - Retrained RMSE: 40732.0100
2024-11-08 03:41:46,681 - INFO - Model cat - Retrained RMSE: 11779.4279
2024-11-08 03:41:47,390 - INFO - Model rf - Retrained RMSE: 80469.7491
2024-11-08 03:41:47,700 - INFO - Model etr - Retrained RMSE: 58839.9184
2024-11-08 03:41:48,036 - INFO - Model gbr - Retrained RMSE: 20857.9172
2024-11-08 03:41:48,036 - INFO - Model Weights for Cluster 0: [0.04976283 0.12488077 0.43182445 0.06321189 0.08644888 0.24387118]
2024-11-08 03:41:48,038 - INFO - Retraining models for Cluster 1 on full data
2024-11-08 03:41:48,264 - INFO - Model lgb - Retrained RMSE: 13757.0838
2024-11-08 03:41:48,420 - INFO - Model xgb - Retrained RMSE: 10837.5265
2024-11-08 03:41:50,859 - INFO - Model cat - Retrained RMSE: 5880.3819
2024-11-08 03:42:06,629 - INFO - Model rf - Retrained RMSE: 11701.7488
2024-11-08 03:42:11,173 - INFO - Model etr - Retrained RMSE: 13334.9480
2024-11-08 03:42:18,426 - INFO - Model gbr - Retrained RMSE: 8762.0623
2024-11-08 03:42:18,427 - INFO - Model Weights for Cluster 1: [0.11924274 0.15136594 0.27896697 0.14018694 0.12301753 0.18721989]
2024-11-08 03:42:18,528 - INFO - Models and preprocessors saved.
2024-11-08 03:42:18,546 - INFO - Columns in test_cleaned.csv: Index(['manufactured', 'vehicle_type_bus_mini_bus', 'vehicle_type_hatchback',
       'vehicle_type_luxury_sedan', 'vehicle_type_midsized_sedan',
       'vehicle_type_mpv', 'vehicle_type_others', 'vehicle_type_sports_car',
       'vehicle_type_stationwagon', 'vehicle_type_suv', 'vehicle_type_truck',
       'vehicle_type_van', 'transmission_type_auto',
       'transmission_type_manual', 'almost_new_car', 'coe_car',
       'consignment_car', 'direct_owner_sale', 'electric_cars', 'hybrid_cars',
       'imported_used_vehicle', 'low_mileage_car', 'opc_car', 'parf_car',
       'premium_ad_car', 'rare_exotic', 'sgcarmart_warranty_cars',
       'sta_evaluated_car', 'vintage_cars', 'curb_weight', 'power',
       'engine_cap', 'no_of_owners', 'depreciation', 'coe', 'road_tax',
       'dereg_value', 'omv', 'arf', 'vehicle_age'],
      dtype='object')
2024-11-08 03:42:18,583 - INFO - Predicting for Cluster 0
2024-11-08 03:42:18,647 - INFO - Predicting for Cluster 1
2024-11-08 03:42:18,893 - INFO - Predictions complete. Submission file saved as submission.csv.
2024-11-08 03:42:18,894 - INFO - 
Prediction statistics:
2024-11-08 03:42:18,894 - INFO - Minimum: 4270.441186249845
2024-11-08 03:42:18,895 - INFO - Maximum: 2170290.1131051257
2024-11-08 03:42:18,895 - INFO - Mean: 115481.36243730746
2024-11-08 03:42:18,895 - INFO - Median: 79616.34205924883
2024-11-08 03:42:18,895 - INFO - 
Processing training data...
2024-11-08 03:42:19,075 - INFO - Training data with ref_price saved to train.csv
2024-11-08 03:42:19,075 - INFO - 
Processing test data...
2024-11-08 03:42:19,121 - INFO - Test data with ref_price saved to test.csv
2024-11-08 03:42:19,121 - INFO - 
Ref_price statistics for training data:
2024-11-08 03:42:19,123 - INFO - count    2.000000e+04
mean     1.129187e+05
std      1.480466e+05
min      2.214320e+03
25%      4.963221e+04
50%      7.788101e+04
75%      1.239775e+05
max      2.414743e+06
Name: ref_price, dtype: float64
2024-11-08 03:42:19,124 - INFO - 
Ref_price statistics for test data:
2024-11-08 03:42:19,126 - INFO - count    5.000000e+03
mean     1.154814e+05
std      1.508126e+05
min      4.270441e+03
25%      5.000678e+04
50%      7.961634e+04
75%      1.252780e+05
max      2.170290e+06
Name: ref_price, dtype: float64
